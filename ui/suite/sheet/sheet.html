<link rel="stylesheet" href="sheet/sheet.css" />

<div class="sheet-app" id="sheet-app">
    <div class="sheet-toolbar">
        <div class="toolbar-left">
            <input
                type="text"
                class="sheet-name-input"
                id="sheetName"
                value="Untitled Spreadsheet"
                spellcheck="false"
            />
        </div>
        <div class="toolbar-center">
            <div class="toolbar-group">
                <button class="btn-icon" id="undoBtn" title="Undo (Ctrl+Z)">
                    <svg
                        width="16"
                        height="16"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                    >
                        <path d="M3 7v6h6"></path>
                        <path
                            d="M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"
                        ></path>
                    </svg>
                </button>
                <button class="btn-icon" id="redoBtn" title="Redo (Ctrl+Y)">
                    <svg
                        width="16"
                        height="16"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                    >
                        <path d="M21 7v6h-6"></path>
                        <path
                            d="M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3L21 13"
                        ></path>
                    </svg>
                </button>
            </div>
            <span class="toolbar-divider"></span>
            <div class="toolbar-group">
                <select
                    class="toolbar-select font-family"
                    id="fontFamily"
                    title="Font"
                >
                    <option value="Arial">Arial</option>
                    <option value="Helvetica">Helvetica</option>
                    <option value="Times New Roman">Times</option>
                    <option value="Courier New">Courier</option>
                    <option value="Georgia">Georgia</option>
                    <option value="Verdana">Verdana</option>
                </select>
                <select
                    class="toolbar-select font-size"
                    id="fontSize"
                    title="Size"
                >
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                    <option value="11" selected>11</option>
                    <option value="12">12</option>
                    <option value="14">14</option>
                    <option value="16">16</option>
                    <option value="18">18</option>
                    <option value="24">24</option>
                    <option value="36">36</option>
                </select>
            </div>
            <span class="toolbar-divider"></span>
            <div class="toolbar-group format-group">
                <button class="btn-icon" id="boldBtn" title="Bold (Ctrl+B)">
                    <strong>B</strong>
                </button>
                <button class="btn-icon" id="italicBtn" title="Italic (Ctrl+I)">
                    <em>I</em>
                </button>
                <button
                    class="btn-icon"
                    id="underlineBtn"
                    title="Underline (Ctrl+U)"
                >
                    <u>U</u>
                </button>
                <button class="btn-icon" id="strikeBtn" title="Strikethrough">
                    <s>S</s>
                </button>
            </div>
            <span class="toolbar-divider"></span>
            <div class="toolbar-group">
                <button
                    class="btn-icon color-btn"
                    id="textColorBtn"
                    title="Text Color"
                >
                    <span class="color-letter">A</span>
                    <span
                        class="color-indicator"
                        id="textColorIndicator"
                    ></span>
                    <input
                        type="color"
                        class="color-input"
                        id="textColorInput"
                        value="#000000"
                    />
                </button>
                <button
                    class="btn-icon color-btn"
                    id="bgColorBtn"
                    title="Fill Color"
                >
                    <svg
                        width="16"
                        height="16"
                        viewBox="0 0 24 24"
                        fill="currentColor"
                    >
                        <rect
                            x="3"
                            y="3"
                            width="18"
                            height="18"
                            rx="2"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="2"
                        />
                    </svg>
                    <span
                        class="color-indicator bg-indicator"
                        id="bgColorIndicator"
                    ></span>
                    <input
                        type="color"
                        class="color-input"
                        id="bgColorInput"
                        value="#ffffff"
                    />
                </button>
            </div>
            <span class="toolbar-divider"></span>
            <div class="toolbar-group">
                <button class="btn-icon" id="alignLeftBtn" title="Align Left">
                    <svg
                        width="16"
                        height="16"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                    >
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="12" x2="15" y2="12"></line>
                        <line x1="3" y1="18" x2="18" y2="18"></line>
                    </svg>
                </button>
                <button
                    class="btn-icon"
                    id="alignCenterBtn"
                    title="Align Center"
                >
                    <svg
                        width="16"
                        height="16"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                    >
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="6" y1="12" x2="18" y2="12"></line>
                        <line x1="4" y1="18" x2="20" y2="18"></line>
                    </svg>
                </button>
                <button class="btn-icon" id="alignRightBtn" title="Align Right">
                    <svg
                        width="16"
                        height="16"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                    >
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="9" y1="12" x2="21" y2="12"></line>
                        <line x1="6" y1="18" x2="21" y2="18"></line>
                    </svg>
                </button>
            </div>
            <span class="toolbar-divider"></span>
            <div class="toolbar-group">
                <button class="btn-icon" id="mergeCellsBtn" title="Merge Cells">
                    <svg
                        width="16"
                        height="16"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                    >
                        <rect x="3" y="3" width="18" height="18" rx="2"></rect>
                        <line x1="12" y1="3" x2="12" y2="21"></line>
                        <path
                            d="M9 12h6M9 12l2-2M9 12l2 2M15 12l-2-2M15 12l-2 2"
                        ></path>
                    </svg>
                </button>
                <button
                    class="btn-icon"
                    id="formatCurrencyBtn"
                    title="Format as Currency"
                >
                    <span>$</span>
                </button>
                <button
                    class="btn-icon"
                    id="formatPercentBtn"
                    title="Format as Percent"
                >
                    <span>%</span>
                </button>
            </div>
        </div>
        <div class="toolbar-right">
            <div class="collaborators" id="collaborators"></div>
            <button class="btn-primary" id="shareBtn">
                <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                >
                    <circle cx="18" cy="5" r="3"></circle>
                    <circle cx="6" cy="12" r="3"></circle>
                    <circle cx="18" cy="19" r="3"></circle>
                    <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
                    <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
                </svg>
                <span>Share</span>
            </button>
            <button
                class="btn-icon chat-toggle"
                id="chatToggle"
                title="Toggle AI Chat"
            >
                <svg
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                >
                    <path
                        d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"
                    ></path>
                </svg>
            </button>
        </div>
    </div>

    <div class="sheet-main">
        <div class="sheet-content">
            <div class="formula-bar">
                <div class="cell-address" id="cellAddress">A1</div>
                <span class="formula-icon">fx</span>
                <input
                    type="text"
                    class="formula-input"
                    id="formulaInput"
                    placeholder="Enter value or formula..."
                />
            </div>

            <div class="sheet-grid-container" id="gridContainer">
                <div class="sheet-grid" id="sheetGrid">
                    <div class="grid-corner"></div>
                    <div class="column-headers" id="columnHeaders"></div>
                    <div class="row-headers" id="rowHeaders"></div>
                    <div class="cells-container" id="cellsContainer">
                        <div class="cells" id="cells"></div>
                        <div class="selection-box" id="selectionBox"></div>
                        <div class="copy-box hidden" id="copyBox"></div>
                        <div class="autofill-handle" id="autofillHandle"></div>
                        <div
                            class="cursor-indicators"
                            id="cursorIndicators"
                        ></div>
                    </div>
                </div>
            </div>

            <div class="sheet-tabs-container">
                <div class="sheet-tabs" id="worksheetTabs">
                    <div class="sheet-tab active" data-index="0">
                        <span>Sheet1</span>
                        <button class="tab-menu-btn">▼</button>
                    </div>
                </div>
                <button
                    class="btn-add-sheet"
                    id="addSheetBtn"
                    title="Add Sheet"
                >
                    <svg
                        width="14"
                        height="14"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                    >
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                </button>
            </div>

            <div class="sheet-status-bar">
                <div class="status-left">
                    <span id="selectionInfo">Ready</span>
                </div>
                <div class="status-center">
                    <span id="calculationResult"></span>
                </div>
                <div class="status-right">
                    <span id="saveStatus">Saved</span>
                    <div class="zoom-control">
                        <button class="btn-zoom" id="zoomOutBtn">−</button>
                        <span id="zoomLevel">100%</span>
                        <button class="btn-zoom" id="zoomInBtn">+</button>
                    </div>
                </div>
            </div>
        </div>

        <aside class="chat-panel" id="chatPanel">
            <div class="chat-header">
                <div class="chat-title">
                    <div class="chat-avatar">
                        <svg
                            width="20"
                            height="20"
                            viewBox="0 0 24 24"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="2"
                        >
                            <path
                                d="M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2zm0 18a8 8 0 1 1 8-8 8 8 0 0 1-8 8z"
                            />
                            <circle cx="12" cy="10" r="3" />
                            <path
                                d="M12 15c-3 0-5 1.5-5 3v1h10v-1c0-1.5-2-3-5-3z"
                            />
                        </svg>
                    </div>
                    <div>
                        <h3>AI Assistant</h3>
                        <span class="chat-status">Ready to help</span>
                    </div>
                </div>
                <button class="chat-close" id="chatClose" title="Close">
                    <svg
                        width="18"
                        height="18"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                    >
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="chat-messages" id="chatMessages">
                <div class="chat-message assistant">
                    <div class="message-bubble">
                        <p>
                            Hi! I can help you edit your spreadsheet. Try asking
                            me to:
                        </p>
                        <ul>
                            <li>Sum a column or range</li>
                            <li>Format cells as currency</li>
                            <li>Create a chart</li>
                            <li>Sort or filter data</li>
                            <li>Apply conditional formatting</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="chat-suggestions" id="chatSuggestions">
                <button class="suggestion-btn" data-action="sum">
                    Sum column B
                </button>
                <button class="suggestion-btn" data-action="format">
                    Format as $
                </button>
                <button class="suggestion-btn" data-action="chart">
                    Create chart
                </button>
                <button class="suggestion-btn" data-action="sort">
                    Sort A-Z
                </button>
            </div>
            <form class="chat-input-container" id="chatForm">
                <input
                    type="text"
                    class="chat-input"
                    id="chatInput"
                    placeholder="Ask me to edit your spreadsheet..."
                    autocomplete="off"
                />
                <button
                    type="submit"
                    class="chat-send"
                    id="chatSend"
                    title="Send"
                >
                    <svg
                        width="18"
                        height="18"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                    >
                        <line x1="22" y1="2" x2="11" y2="13"></line>
                        <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                    </svg>
                </button>
            </form>
        </aside>
    </div>
</div>

<div class="context-menu hidden" id="contextMenu">
    <div class="context-item" data-action="cut">
        Cut <span class="shortcut">Ctrl+X</span>
    </div>
    <div class="context-item" data-action="copy">
        Copy <span class="shortcut">Ctrl+C</span>
    </div>
    <div class="context-item" data-action="paste">
        Paste <span class="shortcut">Ctrl+V</span>
    </div>
    <div class="context-divider"></div>
    <div class="context-item" data-action="insertRowAbove">
        Insert row above
    </div>
    <div class="context-item" data-action="insertRowBelow">
        Insert row below
    </div>
    <div class="context-item" data-action="insertColLeft">
        Insert column left
    </div>
    <div class="context-item" data-action="insertColRight">
        Insert column right
    </div>
    <div class="context-divider"></div>
    <div class="context-item" data-action="deleteRow">Delete row</div>
    <div class="context-item" data-action="deleteCol">Delete column</div>
    <div class="context-divider"></div>
    <div class="context-item" data-action="clearContents">Clear contents</div>
    <div class="context-item" data-action="clearFormatting">
        Clear formatting
    </div>
</div>

<div class="modal hidden" id="shareModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Share Spreadsheet</h3>
            <button class="btn-close" id="closeShareModal">×</button>
        </div>
        <div class="modal-body">
            <div class="share-input-group">
                <input
                    type="email"
                    placeholder="Enter email address"
                    id="shareEmail"
                />
                <select id="sharePermission">
                    <option value="view">Can view</option>
                    <option value="edit">Can edit</option>
                </select>
                <button class="btn-primary" id="sendShareBtn">Share</button>
            </div>
            <div class="share-link-section">
                <h4>Or share with link</h4>
                <div class="share-link-group">
                    <input type="text" readonly id="shareLink" />
                    <button class="btn-icon" id="copyLinkBtn" title="Copy link">
                        <svg
                            width="16"
                            height="16"
                            viewBox="0 0 24 24"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="2"
                        >
                            <rect
                                x="9"
                                y="9"
                                width="13"
                                height="13"
                                rx="2"
                                ry="2"
                            ></rect>
                            <path
                                d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"
                            ></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal hidden" id="chartModal">
    <div class="modal-content modal-large">
        <div class="modal-header">
            <h3>Insert Chart</h3>
            <button class="btn-close" id="closeChartModal">×</button>
        </div>
        <div class="modal-body">
            <div class="chart-type-selector">
                <button class="chart-type-btn active" data-type="bar">
                    <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="currentColor"
                    >
                        <rect x="3" y="12" width="4" height="9"></rect>
                        <rect x="10" y="6" width="4" height="15"></rect>
                        <rect x="17" y="3" width="4" height="18"></rect>
                    </svg>
                    <span>Bar</span>
                </button>
                <button class="chart-type-btn" data-type="line">
                    <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                    >
                        <polyline points="3 18 9 12 13 16 21 6"></polyline>
                    </svg>
                    <span>Line</span>
                </button>
                <button class="chart-type-btn" data-type="pie">
                    <svg
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                    >
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M12 2v10l8.5 5"></path>
                    </svg>
                    <span>Pie</span>
                </button>
            </div>
            <div class="chart-options">
                <label>Data Range</label>
                <input
                    type="text"
                    id="chartDataRange"
                    placeholder="e.g., A1:B10"
                />
                <label>Chart Title</label>
                <input
                    type="text"
                    id="chartTitle"
                    placeholder="Enter chart title"
                />
            </div>
            <div class="modal-actions">
                <button class="btn-secondary" id="cancelChartBtn">
                    Cancel
                </button>
                <button class="btn-primary" id="insertChartBtn">
                    Insert Chart
                </button>
            </div>
        </div>
    </div>
</div>

<script src="sheet/sheet.js"></script>
